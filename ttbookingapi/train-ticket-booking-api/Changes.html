<!DOCTYPE html>
<html>
<head>
    <title>Eureka</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #ffffff; color: #333; margin: 0; padding: 20px; }
        .header { background-color: #1d1d1d; color: white; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { margin: 0; font-size: 24px; font-weight: normal; }
        .section { margin-top: 30px; }
        .section h2 { border-bottom: 1px solid #ccc; padding-bottom: 10px; color: #777; font-size: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { text-align: left; padding: 12px; border-bottom: 1px solid #eee; }
        th { font-weight: bold; color: #555; }
        .status-up { color: green; font-weight: bold; }
        .status-down { color: red; font-weight: bold; }
        .app-name { font-weight: bold; color: #007bff; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Spring Eureka</h1>
        <span>System Status: <b>UP</b></span>
    </div>

    <div class="section">
        <h2>System Status</h2>
        <table>
            <tr><td><b>Environment</b></td><td>Production</td></tr>
            <tr><td><b>Data Center</b></td><td>default</td></tr>
            <tr><td><b>Current Time</b></td><td id="time">Loading...</td></tr>
        </table>
    </div>

    <div class="section">
        <h2>DS Replicas</h2>
        <p>Instances currently registered with Eureka</p>
        <table>
            <thead>
                <tr><th>Application</th><th>AMIs</th><th>Availability Zones</th><th>Status</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td class="app-name">PRODUCT-SERVICE</td>
                    <td>n/a (1)</td>
                    <td>(1)</td>
                    <td><span class="status-up">UP (1)</span> - 192.168.1.10:8081</td>
                </tr>
                <tr>
                    <td class="app-name">ORDER-SERVICE</td>
                    <td>n/a (1)</td>
                    <td>(1)</td>
                    <td><span class="status-up">UP (1)</span> - 192.168.1.12:8082</td>
                </tr>
                <tr>
                    <td class="app-name">INVENTORY-SERVICE</td>
                    <td>n/a (1)</td>
                    <td>(1)</td>
                    <td><span class="status-up">UP (1)</span> - 192.168.1.15:8083</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // Simple script to keep the time "live" so it looks real
        document.getElementById('time').innerText = new Date().toString();
    </script>
</body>
</html>








<!DOCTYPE html>
<html>
<head>
    <title>Circuit Breaker Pattern Demo</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f4f9; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        h1 { color: #333; }
        .container { display: flex; align-items: center; justify-content: space-between; width: 800px; margin-top: 50px; }
        
        /* The Boxes */
        .box { width: 150px; height: 100px; border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: all 0.3s; }
        .client { background-color: #3498db; color: white; }
        .service { background-color: #2ecc71; color: white; }
        .service.dead { background-color: #e74c3c; } /* Red when dead */

        /* The Circuit Breaker Symbol */
        .breaker-container { position: relative; width: 200px; height: 120px; border: 3px dashed #bbb; border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; background: white; }
        .switch { font-size: 40px; font-weight: bold; }
        .status-text { margin-top: 5px; font-size: 14px; font-weight: bold; color: #555; }
        
        .closed { color: #2ecc71; } /* Green */
        .open { color: #e74c3c; }   /* Red */

        /* Connection Lines */
        .line { height: 4px; width: 50px; background-color: #bbb; }
        
        /* Controls */
        .controls { margin-top: 50px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; border: none; border-radius: 5px; margin: 0 10px; transition: 0.2s; }
        .btn-req { background-color: #3498db; color: white; }
        .btn-req:hover { background-color: #2980b9; }
        .btn-kill { background-color: #e74c3c; color: white; }
        .btn-kill:hover { background-color: #c0392b; }

        /* Console Log */
        #console { width: 800px; height: 150px; background: #222; color: #0f0; font-family: monospace; padding: 10px; margin-top: 20px; border-radius: 5px; overflow-y: scroll; font-size: 14px; }
        .log-err { color: #ff5555; }
        .log-warn { color: #ffff55; }
    </style>
</head>
<body>

    <h1>Circuit Breaker Dashboard</h1>

    <div class="container">
        <div class="box client">
            <span>Client App</span>
            <small>(User)</small>
        </div>

        <div class="line"></div>

        <div class="breaker-container">
            <div id="cb-icon" class="switch closed">‚óè CLOSED</div>
            <div id="cb-stats" class="status-text">Failures: 0/3</div>
        </div>

        <div class="line"></div>

        <div id="service-box" class="box service">
            <span>Product Service</span>
            <small id="svc-status">Status: ONLINE</small>
        </div>
    </div>

    <div class="controls">
        <h3>Simulation Controls</h3>
        <p>1. Make requests. 2. Kill the service. 3. Watch the breaker open.</p>
        <button class="btn-req" onclick="makeRequest()">Send User Request</button>
        <button class="btn-kill" onclick="toggleServiceHealth()">Toggle Service Health</button>
        <button onclick="resetDemo()">Reset Demo</button>
    </div>

    <div id="console">System Ready...<br></div>

    <script>
        // State Variables
        let isServiceHealthy = true;
        let failureCount = 0;
        let isCircuitOpen = false;
        const FAILURE_THRESHOLD = 3;

        // Visual Elements
        const serviceBox = document.getElementById('service-box');
        const svcStatus = document.getElementById('svc-status');
        const cbIcon = document.getElementById('cb-icon');
        const cbStats = document.getElementById('cb-stats');
        const consoleLog = document.getElementById('console');

        function log(msg, type = '') {
            const span = `<span class="${type}">${new Date().toLocaleTimeString()} > ${msg}</span><br>`;
            consoleLog.innerHTML = span + consoleLog.innerHTML;
        }

        function toggleServiceHealth() {
            isServiceHealthy = !isServiceHealthy;
            if (isServiceHealthy) {
                serviceBox.classList.remove('dead');
                serviceBox.classList.add('service');
                svcStatus.innerText = "Status: ONLINE";
                log("Service recovered. It is HEALTHY now.");
            } else {
                serviceBox.classList.remove('service');
                serviceBox.classList.add('dead');
                svcStatus.innerText = "Status: CRASHED";
                log("Service has CRASHED.", 'log-err');
            }
        }

        function makeRequest() {
            // SCENARIO 1: Circuit is OPEN (Fail Fast)
            if (isCircuitOpen) {
                log("BLOCKED: Circuit is OPEN. Request not sent to service.", 'log-warn');
                log("FALLBACK: Returning cached default data to user.");
                return;
            }

            // SCENARIO 2: Service is Healthy (Success)
            if (isServiceHealthy) {
                log("SUCCESS: 200 OK - Data received from Product Service.");
                failureCount = 0; // Reset failures on success
                updateStats();
            } 
            // SCENARIO 3: Service is Dead (Failure)
            else {
                failureCount++;
                log(`ERROR: 500 Server Error - Connection Timeout. (Failures: ${failureCount})`, 'log-err');
                updateStats();

                if (failureCount >= FAILURE_THRESHOLD) {
                    tripCircuit();
                }
            }
        }

        function tripCircuit() {
            isCircuitOpen = true;
            cbIcon.innerText = "‚äó OPEN";
            cbIcon.classList.remove('closed');
            cbIcon.classList.add('open');
            log("!!! THRESHOLD REACHED. CIRCUIT TRIPPED !!!", 'log-err');
            
            // Auto-reset simulation after 5 seconds
            setTimeout(() => {
                log("TIMEOUT: Testing connection (Half-Open state)...", 'log-warn');
                if(isServiceHealthy) {
                    resetCircuit();
                } else {
                     log("Check failed. Circuit staying OPEN.", 'log-err');
                }
            }, 8000);
        }

        function resetCircuit() {
            isCircuitOpen = false;
            failureCount = 0;
            cbIcon.innerText = "‚óè CLOSED";
            cbIcon.classList.remove('open');
            cbIcon.classList.add('closed');
            updateStats();
            log("CIRCUIT CLOSED. Traffic flowing normally.");
        }

        function updateStats() {
            cbStats.innerText = `Failures: ${failureCount}/${FAILURE_THRESHOLD}`;
        }
        
        function resetDemo() {
            isServiceHealthy = true;
            isCircuitOpen = false;
            failureCount = 0;
            serviceBox.classList.remove('dead');
            serviceBox.classList.add('service');
            svcStatus.innerText = "Status: ONLINE";
            cbIcon.innerText = "‚óè CLOSED";
            cbIcon.classList.remove('open');
            cbIcon.classList.add('closed');
            updateStats();
            consoleLog.innerHTML = "System Reset...<br>";
        }
    </script>
</body>
</html>












<!DOCTYPE html>
<html>
<head>
    <title>Bulkhead Pattern Demo</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { display: flex; gap: 40px; margin-top: 20px; }
        
        /* The Service Cards */
        .service-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 300px; text-align: center; }
        .service-title { font-weight: bold; font-size: 18px; margin-bottom: 10px; display: block; }
        
        /* The Resource Slots */
        .pool-container { background: #eee; padding: 10px; border-radius: 8px; margin: 15px 0; min-height: 50px; display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; }
        .slot { width: 25px; height: 25px; border-radius: 50%; border: 2px solid #ccc; background: white; transition: all 0.2s; }
        .slot.busy-heavy { background-color: #e74c3c; border-color: #c0392b; } /* Red for heavy tasks */
        .slot.busy-light { background-color: #2ecc71; border-color: #27ae60; } /* Green for light tasks */
        
        /* Buttons */
        button { padding: 10px 15px; margin: 5px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; color: white; transition: 0.2s; }
        .btn-heavy { background-color: #e74c3c; } /* Red */
        .btn-heavy:hover { background-color: #c0392b; }
        .btn-light { background-color: #2ecc71; } /* Green */
        .btn-light:hover { background-color: #27ae60; }
        .btn-toggle { background-color: #34495e; margin-bottom: 20px; }
        
        /* Status Text */
        .status { height: 20px; color: #555; font-size: 14px; margin-top: 5px; font-weight: bold;}
        .error-msg { color: red; animation: flash 1s; }
        
        @keyframes flash { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }

        /* Mode Indicator */
        #mode-display { font-size: 22px; font-weight: bold; color: #333; margin-bottom: 10px; }
        .mode-desc { max-width: 600px; text-align: center; color: #666; margin-bottom: 30px; }
    </style>
</head>
<body>

    <h1>Bulkhead Pattern Simulator</h1>
    
    <div id="mode-display">Mode: Shared Resources (Monolith)</div>
    <div class="mode-desc" id="mode-desc">
        All tasks compete for the SAME pool of threads. If heavy tasks take them all, light tasks wait or fail.
    </div>

    <button class="btn-toggle" onclick="toggleMode()">Switch to Bulkhead Mode</button>

    <div class="container">
        
        <div class="service-card">
            <span class="service-title">üé• Video Processing Service</span>
            <p>Task Duration: 5 Seconds</p>
            <div id="pool-heavy" class="pool-container">
                </div>
            <button class="btn-heavy" onclick="addTask('heavy')">Start Heavy Task</button>
            <div id="status-heavy" class="status"></div>
        </div>

        <div class="service-card">
            <span class="service-title">üîê User Login Service</span>
            <p>Task Duration: 0.5 Seconds</p>
            <div id="pool-light" class="pool-container">
                </div>
            <button class="btn-light" onclick="addTask('light')">Start Login Task</button>
            <div id="status-light" class="status"></div>
        </div>

    </div>

    <script>
        let isBulkheadMode = false;
        const TOTAL_SLOTS = 10;
        const BULKHEAD_SPLIT = 5; // 5 slots for heavy, 5 for light in bulkhead mode
        
        // State
        let activeTasks = { heavy: 0, light: 0 };

        function renderPools() {
            const heavyContainer = document.getElementById('pool-heavy');
            const lightContainer = document.getElementById('pool-light');
            heavyContainer.innerHTML = '';
            lightContainer.innerHTML = '';

            if (!isBulkheadMode) {
                // Shared Mode: Heavy container holds ALL slots visually
                lightContainer.style.display = 'none'; // Hide light pool container
                
                for(let i=0; i<TOTAL_SLOTS; i++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    // Visual logic for shared pool
                    if (i < activeTasks.heavy) slot.classList.add('busy-heavy');
                    else if (i < activeTasks.heavy + activeTasks.light) slot.classList.add('busy-light');
                    heavyContainer.appendChild(slot);
                }
            } else {
                // Bulkhead Mode: Separate containers
                lightContainer.style.display = 'flex';

                // Heavy Pool
                for(let i=0; i<BULKHEAD_SPLIT; i++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    if (i < activeTasks.heavy) slot.classList.add('busy-heavy');
                    heavyContainer.appendChild(slot);
                }
                // Light Pool
                for(let i=0; i<BULKHEAD_SPLIT; i++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    if (i < activeTasks.light) slot.classList.add('busy-light');
                    lightContainer.appendChild(slot);
                }
            }
        }

        function addTask(type) {
            const totalActive = activeTasks.heavy + activeTasks.light;

            // --- LOGIC FOR SHARED MODE ---
            if (!isBulkheadMode) {
                if (totalActive >= TOTAL_SLOTS) {
                    showError(type, "System Overloaded! No Threads Available.");
                    return;
                }
            } 
            // --- LOGIC FOR BULKHEAD MODE ---
            else {
                if (activeTasks[type] >= BULKHEAD_SPLIT) {
                    showError(type, "Bulkhead Full! Task Rejected.");
                    return;
                }
            }

            // Start the task
            activeTasks[type]++;
            renderPools();

            // Simulate duration
            const duration = type === 'heavy' ? 5000 : 500; // 5s vs 0.5s
            setTimeout(() => {
                activeTasks[type]--;
                renderPools();
            }, duration);
        }

        function showError(type, msg) {
            const el = document.getElementById(type === 'heavy' ? 'status-heavy' : 'status-light');
            el.innerText = msg;
            el.classList.add('error-msg');
            setTimeout(() => {
                el.innerText = "";
                el.classList.remove('error-msg');
            }, 1000);
        }

        function toggleMode() {
            isBulkheadMode = !isBulkheadMode;
            // Reset tasks
            activeTasks = { heavy: 0, light: 0 };
            
            const title = document.getElementById('mode-display');
            const desc = document.getElementById('mode-desc');
            const btn = document.querySelector('.btn-toggle');

            if(isBulkheadMode) {
                title.innerText = "Mode: Bulkhead Pattern (Isolates)";
                title.style.color = "#2ecc71";
                desc.innerText = "Resources are partitioned. Even if Video Processing is 100% full, Login Service has its own dedicated slots.";
                btn.innerText = "Switch to Shared Mode";
            } else {
                title.innerText = "Mode: Shared Resources (Monolith)";
                title.style.color = "#333";
                desc.innerText = "All tasks compete for the SAME pool of threads. If heavy tasks take them all, light tasks wait or fail.";
                btn.innerText = "Switch to Bulkhead Mode";
            }
            renderPools();
        }

        // Init
        renderPools();
    </script>
</body>
</html>










<!DOCTYPE html>
<html>
<head>
    <title>IRCTC Tatkal Simulator (Bulkhead Demo)</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f8f9fa; display: flex; flex-direction: column; align-items: center; padding: 20px; color: #333; }
        h1 { color: #005a9c; } /* IRCTC Blue */
        .container { display: flex; gap: 40px; margin-top: 20px; }
        
        /* The Service Cards */
        .service-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 320px; text-align: center; border-top: 5px solid #ccc; }
        .card-tatkal { border-top-color: #e74c3c; } /* Red for Rush */
        .card-login { border-top-color: #27ae60; }  /* Green for Safe */
        
        .service-title { font-weight: bold; font-size: 20px; margin-bottom: 10px; display: block; }
        .subtitle { color: #777; font-size: 14px; margin-bottom: 15px; }

        /* The Resource Slots */
        .pool-container { background: #eee; padding: 10px; border-radius: 8px; margin: 15px 0; min-height: 60px; display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; }
        .slot { width: 30px; height: 30px; border-radius: 4px; border: 2px solid #ccc; background: white; transition: all 0.2s; display: flex; align-items: center; justify-content: center; font-size: 12px; }
        
        .slot.busy-tatkal { background-color: #e74c3c; border-color: #c0392b; color: white; content: "T"; } 
        .slot.busy-login { background-color: #2ecc71; border-color: #27ae60; color: white; } 
        
        /* Buttons */
        button { padding: 12px 20px; margin: 5px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; color: white; transition: 0.2s; font-size: 14px; }
        .btn-tatkal { background-color: #e74c3c; width: 100%; }
        .btn-tatkal:hover { background-color: #c0392b; }
        .btn-tatkal:active { transform: scale(0.98); }

        .btn-login { background-color: #2ecc71; width: 100%; }
        .btn-login:hover { background-color: #27ae60; }
        .btn-login:active { transform: scale(0.98); }

        .btn-toggle { background-color: #34495e; margin-bottom: 20px; width: auto; padding: 10px 30px; }
        
        /* Status Text */
        .status { height: 25px; color: #555; font-size: 14px; margin-top: 10px; font-weight: bold;}
        .error-msg { color: white; background: #e74c3c; padding: 2px 8px; border-radius: 4px; animation: shake 0.5s; }
        
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }

        /* Mode Indicator */
        #mode-display { font-size: 24px; font-weight: bold; color: #333; margin-bottom: 10px; }
        .mode-desc { max-width: 650px; text-align: center; color: #666; margin-bottom: 30px; line-height: 1.5; }
    </style>
</head>
<body>

    <h1>IRCTC System Simulator</h1>
    
    <div id="mode-display">Mode: Shared Resources (Monolith)</div>
    <div class="mode-desc" id="mode-desc">
        All servers are in one shared pool. If "Tatkal Booking" hogs all connections, users cannot even Login to check PNR status.
    </div>

    <button class="btn-toggle" onclick="toggleMode()">Switch to Bulkhead Mode</button>

    <div class="container">
        
        <div class="service-card card-tatkal">
            <span class="service-title">üöÑ Tatkal Booking</span>
            <div class="subtitle">Heavy Load (Payment/Gateway)<br>Duration: 5 Seconds</div>
            
            <div id="pool-tatkal" class="pool-container">
                </div>
            
            <button class="btn-tatkal" onclick="addTask('tatkal')">‚ö° Book Tatkal Ticket</button>
            <div id="status-tatkal" class="status"></div>
        </div>

        <div class="service-card card-login">
            <span class="service-title">üë§ User Login / PNR</span>
            <div class="subtitle">Light Load (DB Query)<br>Duration: 0.5 Seconds</div>
            
            <div id="pool-login" class="pool-container">
                </div>
            
            <button class="btn-login" onclick="addTask('login')">üîç Check PNR / Login</button>
            <div id="status-login" class="status"></div>
        </div>

    </div>

    <script>
        let isBulkheadMode = false;
        const TOTAL_SLOTS = 12; // Total connections available
        const BULKHEAD_SPLIT = 6; // 6 for Tatkal, 6 for Login
        
        // State
        let activeTasks = { tatkal: 0, login: 0 };

        function renderPools() {
            const tatkalContainer = document.getElementById('pool-tatkal');
            const loginContainer = document.getElementById('pool-login');
            tatkalContainer.innerHTML = '';
            loginContainer.innerHTML = '';

            if (!isBulkheadMode) {
                // Shared Mode: Tatkal container holds ALL slots visually
                loginContainer.innerHTML = '<span style="color:#aaa; font-style:italic; padding-top:20px;">Using Shared Pool -></span>';
                
                for(let i=0; i<TOTAL_SLOTS; i++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    // Visual logic for shared pool
                    if (i < activeTasks.tatkal) {
                        slot.classList.add('busy-tatkal');
                        slot.innerText = "T";
                    }
                    else if (i < activeTasks.tatkal + activeTasks.login) {
                        slot.classList.add('busy-login');
                        slot.innerText = "L";
                    }
                    tatkalContainer.appendChild(slot);
                }
            } else {
                // Bulkhead Mode: Separate containers
                
                // Tatkal Pool
                for(let i=0; i<BULKHEAD_SPLIT; i++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    if (i < activeTasks.tatkal) {
                        slot.classList.add('busy-tatkal');
                        slot.innerText = "T";
                    }
                    tatkalContainer.appendChild(slot);
                }
                // Login Pool
                for(let i=0; i<BULKHEAD_SPLIT; i++) {
                    const slot = document.createElement('div');
                    slot.className = 'slot';
                    if (i < activeTasks.login) {
                        slot.classList.add('busy-login');
                        slot.innerText = "L";
                    }
                    loginContainer.appendChild(slot);
                }
            }
        }

        function addTask(type) {
            const totalActive = activeTasks.tatkal + activeTasks.login;

            // --- LOGIC FOR SHARED MODE ---
            if (!isBulkheadMode) {
                if (totalActive >= TOTAL_SLOTS) {
                    showError(type, "SERVER BUSY! Please try again.");
                    return;
                }
            } 
            // --- LOGIC FOR BULKHEAD MODE ---
            else {
                if (activeTasks[type] >= BULKHEAD_SPLIT) {
                    if(type === 'tatkal') showError(type, "Tatkal Queue Full!");
                    if(type === 'login') showError(type, "Login Queue Full!");
                    return;
                }
            }

            // Start the task
            activeTasks[type]++;
            renderPools();

            // Simulate duration
            const duration = type === 'tatkal' ? 5000 : 500; // 5s vs 0.5s
            setTimeout(() => {
                activeTasks[type]--;
                renderPools();
            }, duration);
        }

        function showError(type, msg) {
            const el = document.getElementById(type === 'tatkal' ? 'status-tatkal' : 'status-login');
            el.innerText = msg;
            el.classList.add('error-msg');
            setTimeout(() => {
                el.innerText = "";
                el.classList.remove('error-msg');
            }, 1000);
        }

        function toggleMode() {
            isBulkheadMode = !isBulkheadMode;
            // Reset tasks for clean switch
            activeTasks = { tatkal: 0, login: 0 };
            
            const title = document.getElementById('mode-display');
            const desc = document.getElementById('mode-desc');
            const btn = document.querySelector('.btn-toggle');

            if(isBulkheadMode) {
                title.innerText = "Mode: Bulkhead Pattern (Safe Mode)";
                title.style.color = "#2ecc71";
                desc.innerText = "We have split the servers. Even if Tatkal is 100% full, the Login/PNR service has its own dedicated connections.";
                btn.innerText = "Reset to Shared Mode";
            } else {
                title.innerText = "Mode: Shared Resources (Monolith)";
                title.style.color = "#333";
                desc.innerText = "All servers are in one shared pool. If 'Tatkal Booking' hogs all connections, users cannot even Login to check PNR status.";
                btn.innerText = "Switch to Bulkhead Mode";
            }
            renderPools();
        }

        // Init
        renderPools();
    </script>
</body>
</html>








<!DOCTYPE html>
<html>
<head>
    <title>Strangler Fig Pattern Demo</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #eef2f3; display: flex; flex-direction: column; align-items: center; padding: 20px; color: #333; }
        
        .layout { display: flex; gap: 50px; margin-top: 40px; align-items: flex-start; }
        
        /* The Boxes */
        .box { padding: 20px; border-radius: 10px; text-align: center; width: 220px; min-height: 150px; position: relative; transition: all 0.5s; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        
        /* Facade */
        .facade { background: #34495e; color: white; border: 4px solid #2c3e50; z-index: 10; }
        .facade::after { content: "‚ñº"; position: absolute; bottom: -30px; left: 50%; transform: translateX(-50%); font-size: 24px; color: #34495e; }

        /* Legacy */
        .legacy { background: #95a5a6; color: white; border: 4px dashed #7f8c8d; }
        .legacy.dying { opacity: 0.5; transform: scale(0.95); }
        .legacy.dead { opacity: 0.2; filter: grayscale(100%); }

        /* New Microservice */
        .microservice { background: #2ecc71; color: white; border: 4px solid #27ae60; opacity: 0.3; transform: scale(0.9); }
        .microservice.active { opacity: 1; transform: scale(1); box-shadow: 0 0 20px rgba(46, 204, 113, 0.6); }

        /* Features inside boxes */
        .feature { background: rgba(255,255,255,0.2); margin: 5px; padding: 5px; border-radius: 4px; font-size: 14px; }
        .feature.migrated { text-decoration: line-through; opacity: 0.5; background: rgba(0,0,0,0.2); }
        
        /* Request Dots */
        .dot { width: 15px; height: 15px; border-radius: 50%; position: absolute; transition: top 1s, left 1s; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .req-search { background: #f1c40f; } /* Yellow */
        .req-cart { background: #e67e22; }   /* Orange */
        .req-profile { background: #3498db; } /* Blue */

        /* Controls */
        .controls { background: white; padding: 20px; border-radius: 10px; margin-top: 40px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 600px; }
        button { padding: 10px 20px; margin: 0 10px; cursor: pointer; border: none; border-radius: 5px; font-weight: bold; color: white; font-size: 14px; transition: 0.2s; }
        
        .btn-send { background-color: #34495e; }
        .btn-send:hover { background-color: #2c3e50; }

        .btn-migrate { background-color: #2ecc71; opacity: 0.5; cursor: not-allowed; }
        .btn-migrate.ready { opacity: 1; cursor: pointer; }

        .switch-container { display: flex; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .switch-box { border: 1px solid #ddd; padding: 10px; border-radius: 5px; }

        h2 { margin-top: 0; }
        .arrow-line { position: absolute; background: #ccc; height: 4px; width: 100px; transform-origin: left center; z-index: 0; }
    </style>
</head>
<body>

    <h1>Strangler Fig Pattern Demo</h1>
    <p>Gradually migrating functionality from a Legacy Monolith to a New Microservice.</p>

    <div class="layout">
        
        <div id="legacy-box" class="box legacy">
            <h3>üèõÔ∏è Legacy Monolith</h3>
            <div id="leg-search" class="feature">üîç Search Function</div>
            <div id="leg-cart" class="feature">üõí Cart Function</div>
            <div id="leg-profile" class="feature">üë§ User Profile</div>
        </div>

        <div class="box facade">
            <h3>üîÄ Strangler Facade</h3>
            <div style="font-size: 12px; margin-top:10px;">Intercepts all calls.<br>Routes based on rules.</div>
        </div>

        <div id="micro-box" class="box microservice">
            <h3>üöÄ New Microservice</h3>
            <div id="new-search" class="feature" style="display:none;">üîç Search v2.0</div>
            <div id="new-cart" class="feature" style="display:none;">üõí Cart v2.0</div>
        </div>

    </div>

    <div class="controls">
        <div class="switch-container">
            <div class="switch-box">
                <h4>1. Send Traffic</h4>
                <button class="btn-send" onclick="sendRequest('search')">Send Search Req</button>
                <button class="btn-send" onclick="sendRequest('cart')">Send Cart Req</button>
                <button class="btn-send" onclick="sendRequest('profile')">Send Profile Req</button>
            </div>
            
            <div class="switch-box">
                <h4>2. Migration Controls</h4>
                <button id="btn-mig-search" class="btn-migrate ready" onclick="migrate('search')">Step 1: Strangle Search</button>
                <button id="btn-mig-cart" class="btn-migrate" onclick="migrate('cart')">Step 2: Strangle Cart</button>
                <button id="btn-kill" class="btn-migrate" style="background-color: #c0392b;" onclick="killLegacy()">Step 3: Kill Legacy</button>
            </div>
        </div>
        <div id="log" style="color: #777; font-size: 14px; min-height: 20px;">System Status: Legacy System handling 100% of traffic.</div>
    </div>

    <script>
        // State
        let routes = {
            search: 'legacy',
            cart: 'legacy',
            profile: 'legacy'
        };

        function sendRequest(type) {
            // Create visual dot
            const dot = document.createElement('div');
            dot.className = `dot req-${type}`;
            document.body.appendChild(dot);

            // 1. Start at Facade
            const facade = document.querySelector('.facade');
            const fRect = facade.getBoundingClientRect();
            
            // Set initial position (simulating coming from user below)
            dot.style.top = (fRect.bottom + 50) + 'px';
            dot.style.left = (fRect.left + fRect.width/2 - 7) + 'px';

            setTimeout(() => {
                // Move to Facade
                dot.style.top = (fRect.top + 50) + 'px';
                
                setTimeout(() => {
                    // 2. Route to Destination
                    const destination = routes[type];
                    const targetBox = destination === 'legacy' ? document.getElementById('legacy-box') : document.getElementById('micro-box');
                    const tRect = targetBox.getBoundingClientRect();

                    dot.style.top = (tRect.top + 50) + 'px';
                    dot.style.left = (tRect.left + tRect.width/2 - 7) + 'px';

                    // Cleanup
                    setTimeout(() => {
                        dot.remove();
                        pulseBox(targetBox);
                        log(`Request (${type}) handled by ${destination === 'legacy' ? 'Legacy Monolith' : 'New Microservice'}`);
                    }, 1000);

                }, 800);
            }, 100);
        }

        function migrate(feature) {
            if (feature === 'search') {
                // Logic
                routes.search = 'microservice';
                
                // Visuals
                document.getElementById('leg-search').classList.add('migrated');
                document.getElementById('micro-box').classList.add('active');
                document.getElementById('new-search').style.display = 'block';
                
                // Button Logic
                document.getElementById('btn-mig-search').classList.remove('ready');
                document.getElementById('btn-mig-search').style.opacity = '0.5';
                document.getElementById('btn-mig-cart').classList.add('ready');
                
                log("MIGRATION: 'Search' traffic now routed to Microservice.");
            }
            else if (feature === 'cart') {
                // Logic
                routes.cart = 'microservice';
                
                // Visuals
                document.getElementById('leg-cart').classList.add('migrated');
                document.getElementById('new-cart').style.display = 'block';
                document.getElementById('legacy-box').classList.add('dying');

                // Button Logic
                document.getElementById('btn-mig-cart').classList.remove('ready');
                document.getElementById('btn-mig-cart').style.opacity = '0.5';
                document.getElementById('btn-kill').classList.add('ready');

                log("MIGRATION: 'Cart' traffic now routed to Microservice. Legacy is dying.");
            }
        }

        function killLegacy() {
            if (!document.getElementById('btn-kill').classList.contains('ready')) return;
            
            document.getElementById('legacy-box').classList.add('dead');
            document.getElementById('leg-profile').classList.add('migrated'); // Assume profile retired
            log("COMPLETE: Legacy System Decommissioned. Long live the Microservice!");
        }

        function pulseBox(element) {
            element.style.transform = "scale(1.05)";
            setTimeout(() => element.style.transform = "scale(1)", 200);
        }

        function log(msg) {
            document.getElementById('log').innerText = msg;
        }
    </script>
</body>
</html>
